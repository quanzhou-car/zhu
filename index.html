<!DOCTYPE html>
<html>
<head>
    <title>LeanCloud-GitHub连接测试</title>
    <!-- 引入 LeanCloud SDK -->
    <script src="//cdn.jsdelivr.net/npm/leancloud-storage@4.13.2/dist/av-min.js"></script>
</head>
<body>
    <h1>LeanCloud数据操作测试</h1>
    <button onclick="createData()">创建数据</button>
    <button onclick="readData()">读取数据</button>
    <button onclick="updateData()">更新数据</button>
    <button onclick="deleteData()">删除数据</button>
    <div id="output"></div>

    <script>
        // 初始化LeanCloud应用（需要替换成你的应用凭证）
        const APP_ID = 'srjSR1AScMqVmTlihhqDUycX-MdYXbMMI';
        const APP_KEY = '5Lq7VvdaCT8Y5jiNA4h1B4kn';
        const SERVER_URL = 'https://srjsr1as.api.lncldglobal.com'; // 国内节点需要填写

        AV.init({
            appId: APP_ID,
            appKey: APP_KEY,
            serverURLs: SERVER_URL
        });

        // 测试用对象
        let testObjectId = null;

        // 输出结果到页面
        function showMessage(message) {
            document.getElementById('output').innerHTML += `<p>${new Date().toLocaleTimeString()}: ${message}</p>`;
        }

        // 创建数据
        async function createData() {
            try {
                const TestObject = AV.Object.extend('TestObject');
                const testObject = new TestObject();
                
                testObject.set('testField', '初始值');
                const savedObject = await testObject.save();
                testObjectId = savedObject.id;
                
                showMessage(`数据创建成功！ID: ${testObjectId}`);
            } catch (error) {
                showMessage(`创建失败: ${error.message}`);
            }
        }

        // 读取数据
        async function readData() {
            if (!testObjectId) {
                showMessage('请先创建数据');
                return;
            }

            try {
                const query = new AV.Query('TestObject');
                const result = await query.get(testObjectId);
                
                showMessage(`读取成功: ${JSON.stringify(result.attributes)}`);
            } catch (error) {
                showMessage(`读取失败: ${error.message}`);
            }
        }

        // 更新数据
        async function updateData() {
            if (!testObjectId) {
                showMessage('请先创建数据');
                return;
            }

            try {
                const testObject = AV.Object.createWithoutData('TestObject', testObjectId);
                testObject.set('testField', '更新后的值');
                await testObject.save();
                
                showMessage('数据更新成功');
            } catch (error) {
                showMessage(`更新失败: ${error.message}`);
            }
        }

        // 删除数据
        async function deleteData() {
            if (!testObjectId) {
                showMessage('请先创建数据');
                return;
            }

            try {
                const testObject = AV.Object.createWithoutData('TestObject', testObjectId);
                await testObject.destroy();
                testObjectId = null;
                
                showMessage('数据删除成功');
            } catch (error) {
                showMessage(`删除失败: ${error.message}`);
            }
        }
    </script>
</body>
</html>